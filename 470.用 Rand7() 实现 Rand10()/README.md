# [470. 用 Rand7() 实现 Rand10()](https://leetcode-cn.com/problems/implement-rand10-using-rand7/solution/cong-zui-ji-chu-de-jiang-qi-ru-he-zuo-dao-jun-yun-/)

`拒绝采样`

## [拒绝采样](https://imageslr.github.io/2020/probility-lc430.html#randm-生成-randn)

### 理论知识

如何利用 `RandM` 生成 `RandN`?

- 已知 `RandM` 能等概率生成 `[0, M-1]` 的随机整数，那么执行 `k` 次，就能生成 `[0, M^k - 1]` 的随机整数
- 由于 `RandN` 需等概率生成 `[0, N-1]` 的随机整数，那么只需取 `k`，使得 `M^k - 1 >= N` 即可
- 有多种方式求得 `RandN`
    - 拒绝采样，只在 `[0, N-1]` 的范围取数，但有可能需要舍弃部分数字，经历多个循环
    - 利用取余运算，在保证等概率的前提下，尽可能限制利用生成的数字的范围，减少舍弃数字的比例，减少循环

### 解题思路

1. 根据上述理论知识，构造 `Rand49`，即 `(Rand7 - 1) * 7 + Rand7`
2. 取 `[1, 40]` 的数字 `n`，`n % 10 + 1` 就在 `[1, 10]` 的范围内

   | rand7/7(rand7 - 1) | 1 | 2 | 3 | 4 | 5 | 6 | 7 |
         | --- | --- | --- | --- | --- | --- | --- | --- |
   | 0 | 1 | 2 | 3 | 4 | 5 | 6 | 7 |
   | 7 | 8 | 9 | 10 | 11 | 12 | 13 | 14 |
   | 14 | 15 | 16 | 17 | 18 | 19 | 20 | 21 |
   | 21 | 22 | 23 | 24 | 25 | 26 | 27 | 28 |
   | 28 | 29 | 30 | 31 | 32 | 33 | 34 | 35 |
   | 35 | 36 | 37 | 38 | 39 | 40 | 41 | 42 | 
   | 42 | 43 | 44 | 45 | 46 | 47 | 48 | 49 |   

### 复杂度

- 时间复杂度：平均时间复杂度为 O(1)，最坏情况为 O(∞)
- 空间复杂度：O(1)

## 合理使用被拒绝的随机数

### 解题思路

1. 上述方法直接舍弃 `[41, 49]` 的数字，实质上是 `[1, 9]` 的随机数
2. 再次调用 `Rand7` 构造 `Rand63`，取 `[1, 60]`，剩余 `[1, 3]` 的随机数
3. 再次调用 `Rand7` 构造 `Rand21`，取 `[1, 10]`, 剩余 `[1]`，可直接舍弃
4. 通过不断调用 `Rand7` 合理利用被拒绝的随机数，减少循环

### 复杂度

- 时空复杂度与第一种方法一致
